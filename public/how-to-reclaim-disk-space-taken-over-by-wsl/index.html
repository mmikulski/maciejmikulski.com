<!DOCTYPE html>
<html lang="en">

<head>
    <title>How to reclaim disk space taken over by WSL | maciejmikulski.com</title>
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    <meta name="robots" content="noodp"/>

    <link rel="stylesheet" href="https://maciejmikulski.com/style.css">
    <link rel="stylesheet" href="https://maciejmikulski.com/color/blue.css">

    <link rel="stylesheet" href="https://maciejmikulski.com/font-hack-subset.css">

    </head>

<body class="">
<div class="container">
    
    <header class="header">
        <div class="header__inner">
            <div class="header__logo">
                    
                <a href="https://maciejmikulski.com" style="text-decoration: none;">
                    <div class="logo">
                      
                            Terminimal theme
                        
                    </div>
                </a>
            </div>
        </div>

        
        <nav class="menu">
            <ul class="menu__inner">
                <li><a href="https://maciejmikulski.com/blog">blog</a></li>
            
                <li><a href="https://maciejmikulski.com/about">about me</a></li>
            </ul>
        </nav>
    
    
        
    </header>
    

    <div class="content">
        
    <div class="post">
        
    <h1 class="post-title"><a href="https://maciejmikulski.com/how-to-reclaim-disk-space-taken-over-by-wsl/">How to reclaim disk space taken over by WSL</a></h1>
    <div class="post-meta-inline">
        
    <span class="post-date">
            2023-05-14
        </span>

    </div>

    

        
        <div class="post-content">
            <p>Partitions used by the WSL distro on Windows are dynamically extended when you need more space for them. Unfortunately it doesn't work the othey way round. Ie. when you clean them up (by removing <code>node_module</code> folders from your experimental repos ;) ) Windows will not scale them down and you'll wonder where did all of the space go.</p>
<p>Fortunately there's a way to do it yourself.</p>
<ol>
<li>Shutdown the WSL. (You may also need to to shutdown the Docker Desktop which will try to restart the WSL.)</li>
</ol>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>wsl.exe --shutdown
</span></code></pre>
<ol start="2">
<li>Call Optimize-VHD commandlet pointing it to the file representing the WSL partition on windows file system.</li>
</ol>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>Optimize-VHD -Path %PROFILE%\AppData\Local\Packages\CanonicalGroupLimited.Ubuntu20.04onWindows_79rhkp1fndgsc\LocalState\ext4.vhdx -Mode Full
</span></code></pre>
<p>If you want to check how much space the distro uses atm:</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>wsl.exe --system -d Ubuntu df -h /mnt/wslg/distro
</span></code></pre>
<p>Cheers!</p>
<p>Bibliography</p>
<h1 id="https-superuser-com-questions-1606213-how-do-i-get-back-unused-disk-space-from-ubuntu-on-wsl2">https://superuser.com/questions/1606213/how-do-i-get-back-unused-disk-space-from-ubuntu-on-wsl2</h1>
<h1 id="https-learn-microsoft-com-en-us-windows-wsl-disk-space">https://learn.microsoft.com/en-us/windows/wsl/disk-space</h1>

        </div>

        
        <div class="pagination">
            <div class="pagination__title">
                <span class="pagination__title-h">Thanks for reading! Read other posts?</span>
                <hr />
            </div>
            <div class="pagination__buttons">
                    <span class="button previous">
                        <a href="https://maciejmikulski.com/test-article/">
                            <span class="button__icon">←</span>&nbsp;
                            <span class="button__text">Test article</span>
                        </a>
                    </span>
                
                </div>
        </div>
    
    </div>

    </div>

    
    <footer class="footer">
        <div class="footer__inner">
                <div class="copyright">
                        <span>© 
    2023
 Powered by <a href="https://www.getzola.org/">Zola</a></span>
                    <span class="copyright-theme">
                        <span class="copyright-theme-sep">:: </span>
                        Theme: <a href="https://github.com/pawroman/zola-theme-terminimal/">Terminimal</a> by pawroman
                    </span>
                </div>
            </div>
    </footer>
    

</div>
</body>

</html>
